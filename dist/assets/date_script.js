function CalendarControl(){const e=new Date,t=new URLSearchParams(window.location.search).get("information"),a=JSON.parse(t);null!=a&&(document.getElementById("timePicker").value=a.time);const n={localDate:new Date,prevMonthLastDate:null,calWeekDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],calMonthName:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],saveData:function(){const e={entity:"date",day:n.selectedDate.getDate(),month:n.calMonthName[n.selectedDate.getMonth()],year:n.selectedDate.getFullYear(),time:document.getElementById("timePicker").value};Office.onReady((function(t){t.host===Office.HostType.Word||t.host===Office.HostType.Excel||t.host===Office.HostType.PowerPoint?Office.context.ui.messageParent(JSON.stringify(e)):console.log("Errore: ambiente Office non riconosciuto")}))},daysInMonth:function(e,t){return new Date(t,e,0).getDate()},firstDay:function(){return new Date(e.getFullYear(),e.getMonth(),1)},lastDay:function(){return new Date(e.getFullYear(),e.getMonth()+1,0)},firstDayNumber:function(){return n.firstDay().getDay()+1},lastDayNumber:function(){return n.lastDay().getDay()+1},getPreviousMonthLastDate:function(){return new Date(e.getFullYear(),e.getMonth(),0).getDate()},navigateToPreviousMonth:function(){e.setMonth(e.getMonth()-1),n.attachEventsOnNextPrev()},navigateToNextMonth:function(){e.setMonth(e.getMonth()+1),n.attachEventsOnNextPrev()},navigateToCurrentMonth:function(){let t=n.localDate.getMonth(),a=n.localDate.getFullYear();e.setMonth(t),e.setYear(a),n.attachEventsOnNextPrev()},displayYear:function(){document.querySelector(".calendar .calendar-year-label").innerHTML=e.getFullYear()},displayMonth:function(){document.querySelector(".calendar .calendar-month-label").innerHTML=n.calMonthName[e.getMonth()]},selectDate:function(t){console.log(`${t.target.textContent} ${n.calMonthName[e.getMonth()]} ${e.getFullYear()}`)},selectDate:function(t){const a=t.target.textContent,l=(n.calMonthName[e.getMonth()],e.getFullYear());n.selectedDate=new Date(l,e.getMonth(),a),document.querySelectorAll(".calendar .number-item").forEach((e=>e.classList.remove("calendar-selected"))),t.target.parentElement.classList.add("calendar-selected"),document.querySelector(".calendar .calendar-today-date").textContent="Selected: "+n.calWeekDays[n.selectedDate.getDay()]+", "+n.selectedDate.getDate()+" "+n.calMonthName[n.selectedDate.getMonth()]+" "+n.selectedDate.getFullYear()},plotSelectors:function(){document.querySelector(".calendar").innerHTML+='<div class="calendar-inner"><div class="calendar-controls">\n          <div class="calendar-prev"><a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 128 128"><path fill="#666" d="M88.2 3.8L35.8 56.23 28 64l7.8 7.78 52.4 52.4 9.78-7.76L45.58 64l52.4-52.4z"/></svg></a></div>\n          <div class="calendar-year-month">\n          <div class="calendar-month-label"></div>\n          <div>-</div>\n          <div class="calendar-year-label"></div>\n          </div>\n          <div class="calendar-next"><a href="#"><svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 128 128"><path fill="#666" d="M38.8 124.2l52.4-52.42L99 64l-7.77-7.78-52.4-52.4-9.8 7.77L81.44 64 29 116.42z"/></svg></a></div>\n          </div>\n          <div class="calendar-today-date"></div>\n          <div class="calendar-body"></div>\n          <div class="bottom-right-button"> \x3c!-- Move the button element here --\x3e\n              <button>Save</button>\n          </div>\n          </div>',document.querySelector(".calendar .bottom-right-button button").addEventListener("click",n.saveData)},plotDayNames:function(){for(let e=0;e<n.calWeekDays.length;e++)document.querySelector(".calendar .calendar-body").innerHTML+=`<div>${n.calWeekDays[e]}</div>`},plotDates:function(){document.querySelector(".calendar .calendar-body").innerHTML="",n.plotDayNames(),n.displayMonth(),n.displayYear();let t=1,a=0;n.prevMonthLastDate=n.getPreviousMonthLastDate();let l=[],o=n.daysInMonth(e.getMonth()+1,e.getFullYear());for(let e=1;e<o;e++)e<n.firstDayNumber()?(a+=1,document.querySelector(".calendar .calendar-body").innerHTML+='<div class="prev-dates"></div>',l.push(n.prevMonthLastDate--)):document.querySelector(".calendar .calendar-body").innerHTML+=`<div class="number-item" data-num=${t}><a class="dateNumber" href="#">${t++}</a></div>`;for(let e=0;e<a+1;e++)document.querySelector(".calendar .calendar-body").innerHTML+=`<div class="number-item" data-num=${t}><a class="dateNumber" href="#">${t++}</a></div>`;n.plotPrevMonthDates(l),n.plotNextMonthDates()},attachEvents:function(){let e=document.querySelector(".calendar .calendar-prev a"),t=document.querySelector(".calendar .calendar-next a"),a=document.querySelector(".calendar .calendar-today-date"),l=document.querySelectorAll(".calendar .dateNumber");e.addEventListener("click",n.navigateToPreviousMonth),t.addEventListener("click",n.navigateToNextMonth),a.addEventListener("click",n.navigateToCurrentMonth);for(var o=0;o<l.length;o++)l[o].addEventListener("click",n.selectDate,!1)},plotPrevMonthDates:function(e){e.reverse();for(let t=0;t<e.length;t++)document.querySelectorAll(".prev-dates")&&(document.querySelectorAll(".prev-dates")[t].textContent=e[t])},plotNextMonthDates:function(){let e=document.querySelector(".calendar-body").childElementCount;if(e>42){let t=49-e;n.loopThroughNextDays(t)}e>35&&e<=42&&n.loopThroughNextDays(42-e)},loopThroughNextDays:function(e){if(e>0)for(let t=1;t<=e;t++)document.querySelector(".calendar-body").innerHTML+=`<div class="next-dates">${t}</div>`},attachEventsOnNextPrev:function(){n.plotDates(),n.attachEvents()},init:function(){let t;if(console.log(a),null!=a){switch(a.month){case"Jan":t=0;break;case"Feb":t=1;break;case"Mar":t=2;break;case"Apr":t=3;break;case"May":t=4;break;case"Jun":t=5;break;case"Jul":t=6;break;case"Aug":t=7;break;case"Sep":t=8;break;case"Oct":t=9;break;case"Nov":t=10;break;case"Dec":t=11}e.setFullYear(a.year,t,a.day)}n.plotSelectors(),n.plotDates(),n.attachEvents(),null!=a&&document.querySelectorAll(".calendar .dateNumber").forEach((n=>{parseInt(n.textContent)===a.day&&e.getMonth()===t&&e.getFullYear()===a.year&&n.parentElement.classList.add("calendar-selected")}))}};n.init()}const calendarControl=new CalendarControl;