const queryParams=new URLSearchParams(window.location.search),information=queryParams.get("information"),parsedInformation=JSON.parse(information);function showRefFields(){document.getElementById("refFields").style.display="block",document.getElementById("mrefFields").style.display="none",document.getElementById("rrefFields").style.display="none",null!=parsedInformation&&(document.getElementById("numeroArticoloRef").value=parsedInformation.number,document.getElementById("documentoRef").value=parsedInformation.documento)}function showMRefFields(){document.getElementById("refFields").style.display="none",document.getElementById("mrefFields").style.display="block",document.getElementById("rrefFields").style.display="none",null!=parsedInformation&&(console.log(parsedInformation.number),document.getElementById("numeriArticoliMRef").value=parsedInformation.number,document.getElementById("documentoMRef").value=parsedInformation.documento)}function showRRefFields(){document.getElementById("refFields").style.display="none",document.getElementById("mrefFields").style.display="none",document.getElementById("rrefFields").style.display="block",console.log(parsedInformation),null!=parsedInformation&&(document.getElementById("dalRRef").value=parsedInformation.dal,document.getElementById("alRRef").value=parsedInformation.al,document.getElementById("documentoRRef").value=parsedInformation.documento)}function submitForm(){let e;switch(document.querySelector('input[name="riferimento"]:checked').value){case"ref":e={entity:"reference",type:"ref",numeroArticolo:document.getElementsByName("numeroArticoloRef")[0].value,documento:document.getElementsByName("documentoRef")[0].value};break;case"mref":e={entity:"reference",type:"mref",numeriArticoli:document.getElementsByName("numeriArticoliMRef")[0].value,documento:document.getElementsByName("documentoMRef")[0].value};break;case"rref":e={entity:"reference",type:"rref",dal:document.getElementsByName("dalRRef")[0].value,al:document.getElementsByName("alRRef")[0].value,documento:document.getElementsByName("documentoRRef")[0].value}}Office.onReady((function(n){n.host===Office.HostType.Word||n.host===Office.HostType.Excel||n.host===Office.HostType.PowerPoint?Office.context.ui.messageParent(JSON.stringify(e)):console.log("Errore: ambiente Office non riconosciuto")}))}null!=parsedInformation&&("ref"==parsedInformation.type?(document.getElementById("reference_ref").checked=!0,showRefFields()):"mref"==parsedInformation.type?(document.getElementById("reference_mref").checked=!0,showMRefFields()):(document.getElementById("reference_rref").checked=!0,showRRefFields()));